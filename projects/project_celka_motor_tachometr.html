<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tachometer monitoring for a racing boat motor</title>
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
  <link rel="manifest" href="/images/favicon/site.webmanifest">
</head>
<body>
  <header>
    <h1>Tachometer monitoring for a racing boat motor</h1>
    <nav>
      <a href="../index.html">Homepage</a>
      <a href="../projects.html">My Projects</a>
      <a href="../about.html">About Me</a>
    </nav>
  </header>

  <main>
    <section class="project-meta">
      <p><strong>Date:</strong> September 2024</p>
      <p><strong>Technologies:</strong> STM32F103, Embedded C, STM32CubeMX, GPIO EXTI, TIM, Infrared sensor</p>
    </section>

    <section class="project-description">
      <h2>Overview</h2>
      <p>
        The goal of this project was to measure the angular velocity of the boat's propeller, powered by a BLDC motor, in real-time. The design emphasized minimal weight and cost.  
        Previously, the motor was controlled by sending a setpoint to the ESC, with no feedback on the actual RPM.  
        This made it difficult to analyze the boat's dynamic response — especially since the ESC's behavior is undocumented and sensitive to battery voltage and load.
      </p>

      <p>
        During a weekend of field tests at Lake Rożnowskie, I researched, designed, and implemented both the hardware and firmware to measure the motor's RPM using an IR reflective proximity sensor as a tachometer.  
        This system will support future work in propulsion modeling and closed-loop motor control.
      </p>

      <h2>Technical Highlights</h2>
      <ul>
        <li>Designed a compact, non-intrusive RPM sensing system using an IR reflective sensor aimed at the rotating engine housing with a reflective sticker on it.</li>
        <li>Selected an available free microcontroller pin on the control board and configured a high-resolution 32-bit timer for precise measurement.</li>
        <li>Added a simple RC low-pass filter to the sensor signal line; cutoff frequency was calculated based on the expected RPM range.</li>
        <li>Processed tachometer pulses on the STM32F446RE using GPIO interrupts and counted revolutions with the timer peripheral.</li>
        <li>Implemented embedded C firmware (bare-metal, CubeMX + HAL) to compute rotational speed from pulse periods.</li>
        <li>Developed a simple algorithm to detect and filter out invalid readings, such as rotations that are too slow or too fast to be realistic.</li>
        <li>Utilized a FreeRTOS task to periodically acquire data and transmit it over the CAN bus.</li>
        <li>Tested the system in outdoor lake conditions during full-speed propulsion trials.</li>
      </ul>

      <h2>Results</h2>
      <p>
        The system successfully measured the motor RPM in real-time under field conditions, providing reliable data.
        The IR sensor proved to be a robust and cost-effective solution for non-intrusive RPM sensing.
        The collected data enabled visualization of the nonlinear relationship between the RPM, the ESC setpoint, and the applied voltage.
  <em>(Note: The visualization and analysis of this data were performed by a team member.)</em>
        This will support future system identification and the development of closed-loop control algorithms.
      </p>
      <p>
        Some challenges included signal noise, and the accuracy has not yet been quantified.
        Future work should include validation against calibrated tachometers.
        There is still room for improvements, such as refining filtering techniques and performing sensor calibration.
      </p>


      <h2>Gallery</h2>
      <figure>
        <img src="../images/project_celka_motor_tachometr/IR_proximity_sensor.jpg" alt="Infrared proximity sensor used in the project" class="project-image" />
        <figcaption>Infrared proximity sensor used in the project</figcaption>
      </figure>

      <figure>
        <img src="../images/project_celka_motor_tachometr/sensor_with_engine.jpg" alt="Infrared sensor mounted near the motor housing" class="project-image" />
        <figcaption>Infrared sensor mounted near the motor housing</figcaption>
      </figure>


    </section>
  </main>


  <footer>
    &copy; 2025 Damian Brzana
  </footer>
</body>
</html>
